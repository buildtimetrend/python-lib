- hosts: all
  tasks:
    - name: "Install git"
      apt: name=git state=latest

    - name: "Install python pip"
      apt: name=python-pip state=latest
      register: pipinstalled

    - name: "Install python nose"
      apt: name=python-nose state=latest
      register: noseinstalled

    - name: "Install required libraries"
      apt: name={{item}} state=latest
      with_items:
        - python-dev
        - libxml2-dev
        - libxslt1-dev
        - zlib1g-dev
        - python-libxml2
        - python-libxslt1
      register: libsinstalled

    - name: "Install buildtimetrend requirements"
      pip: requirements='/vagrant/requirements.txt'
      when: pipinstalled|success and libsinstalled|success

    - name: "Install buildtimetrend native requirements"
      pip: requirements='/vagrant/requirements_native.txt'
      when: pipinstalled|success and libsinstalled|success
